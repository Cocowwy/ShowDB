<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:v-if="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8">
    <title>ShowDB</title>
    <!--Áõ∏ÂÖ≥ÂºïÂÖ•-->
    <link rel="shortcut icon" th:href="@{img/database.png}">
    <script th:src="@{js/vue.min.js}"></script>
    <script th:src="@{js/axios.min.js}"></script>
    <script src="https://unpkg.com/element-ui/lib/index.js"></script>
    <link rel="stylesheet" th:href="@{css/db.css}">
    <link rel="stylesheet" href="https://unpkg.com/element-ui/lib/theme-chalk/index.css">
</head>
<body>
<dev id="ShowDB">
    <!--È°∂ÈÉ®-->
    <el-alert style="font-weight: bold" v-if="customize!=null"
              :title="customize.topAlert"
              type="success"
              @close="starIt" center>
    </el-alert>

    <el-container>

        <el-aside width="8%" v-if="plugin">
            <!--‰æßËæπÁõÆÂΩïÊ†è-->
            <el-menu :default-active="sidebarDirectory" class="el-menu-demo" @select="handleSidebarDirectory">
                <el-menu-item index="1">ÊñáÊ°£ÁõëÊéßÊ®°Âºè</el-menu-item>
                <el-menu-item index="2" :disabled="!plugin.crud">CRUD</el-menu-item>
                <el-menu-item index="3" disabled>ÂºÄÂèë‰∏≠..</el-menu-item>
            </el-menu>
        </el-aside>

        <!--‰∏≠Èó¥Âå∫ÂüüÊäΩÂèñÊàêÂèØÂèòÁöÑÂå∫Âüü-->
        <el-main width="48%" style="margin: 10px">

            <!--Êï∞ÊçÆÊ∫êÈÄâÂèñ-->
            <div v-loading="loadingDataSource">
                <el-radio v-model="currentDataSource" @change="dsChange" v-for="(item,index) in dataSorucesInfo"
                          :label="item.beanName" border>{{item.beanName}}
                </el-radio>
            </div>

            <div v-if="sidebarDirectory == '1'" th:include="component/doc :: doc"></div>

            <div v-if="sidebarDirectory == '2'" th:include="component/crud :: crud"></div>
        </el-main>

        <!--Âè≥‰æßÊï∞ÊçÆÊ∫ê-->
        <el-aside width="20%" style="margin-top: 10px;margin-left: 10px">
            <!--customize-->
            <el-card v-if="customize" :body-style="{ padding: '0px' }"
                     style="width:80%;overflow-x: auto" shadow="hover">
                <img :src="customize.img" class="image" style="width: 100%;display: block;">
                <div style="padding: 14px;">
                    <span style="font-size: large">üë§  {{customize.creator}}</span><br>
                    <span style="font-size: large">üìÆ  {{customize.email}}</span><br>
                    <span style="font-size: large">üóí  {{customize.desc}}</span><br>
                </div>
            </el-card>
            <el-empty v-if="customize==null" description="ÊöÇÊó†Ëá™ÂÆö‰πâÊèèËø∞‰ø°ÊÅØ"></el-empty>

            <el-card style="width:80%;overflow-x: auto" class="box-card"
                     v-if="currentDataSourceInfo!=null" shadow="hover">
                <el-descriptions direction="vertical" :column="1" border v-if="currentDataSourceInfo!=null"
                                 shadow="hover"
                                 :title="currentDataSourceInfo.beanName">
                    <el-descriptions-item label="Êï∞ÊçÆÂ∫ìÁ±ªÂûã">
                        <el-tag size="large" type="info">{{currentDataSourceInfo.dsProductName}}</el-tag>
                    </el-descriptions-item>
                    <el-descriptions-item label="Êï∞ÊçÆÂ∫ìÁâàÊú¨Âè∑">
                        <el-tag size="large" type="success"> {{currentDataSourceInfo.dbVersion}}</el-tag>
                    </el-descriptions-item>
                    <el-descriptions-item label="Êï∞ÊçÆÂ∫ì">
                        <div style="color:black;font-weight:bold;font-size: large">
                            {{currentDataSourceInfo.tableSchema}}
                        </div>
                    </el-descriptions-item>
                    <el-descriptions-item label="Êìç‰ΩúÁ≥ªÁªü">{{currentDataSourceInfo.osEnv}}</el-descriptions-item>
                    <el-descriptions-item label="ËøûÊé•Áî®Êà∑">{{currentDataSourceInfo.username}}</el-descriptions-item>
                    <el-descriptions-item label="ÊÄªËÆ∞ÂΩïÊï∞">{{currentDataSourceInfo.records}} Ë°å</el-descriptions-item>
                    <el-descriptions-item label="ÊÄªÊï∞ÊçÆÈáè">{{currentDataSourceInfo.dataSize}}MB</el-descriptions-item>
                    <el-descriptions-item label="ÊÄªÁ¥¢ÂºïÈáè">{{currentDataSourceInfo.indexSize}}MB</el-descriptions-item>
                    <el-descriptions-item label="Ë∑ØÂæÑ">{{currentDataSourceInfo.baseDir}}</el-descriptions-item>
                    <el-descriptions-item label="ËøûÊé•URL">
                        <el-button :plain="true" @click="showDsUrl(currentDataSourceInfo.url)">ÁÇπÂáªÊü•ÁúãURL</el-button>
                    </el-descriptions-item>
                </el-descriptions>
            </el-card>

            <!--IPÂÆ¢Êà∑Á´Ø‰ø°ÊÅØ-->
            <el-card style="margin-top: 12px;width:80%" class="box-card"
                     v-if="ipConInfo!=null" shadow="hover">
                <div slot="header" class="clearfix">
                    <span style="font-size: 32px;font-weight: 700;">ÂÆ¢Êà∑Á´ØËøûÊé•‰ø°ÊÅØ</span>
                </div>
                <el-table :data="ipConInfo" border>
                    <el-table-column prop="ip" label="IP"></el-table-column>
                    <el-table-column prop="count" label="ËøûÊé•Êï∞Èáè"></el-table-column>
                </el-table>
            </el-card>


            <!--‰∏ª‰ªé‰ø°ÊÅØ  IDEAÁöÑÈ£òÁ∫¢‰∏çÁÆ°-->
            <el-card style="margin-top: 12px;width:80%" class="box-card"
                     v-if="currentDataSourceMasterSlaveInfo==null"
                     shadow="hover">
                <el-empty th:image="@{img/masterSlave.png}"
                          description="ÊöÇÊú™Ê£ÄÊµãÂà∞ÂΩìÂâçÊï∞ÊçÆÊ∫êÂ≠òÂú®‰∏ª‰ªé‰ø°ÊÅØ">
                </el-empty>
            </el-card>
            <el-card style="margin-top: 12px;width:80%" class="box-card"
                     v-if="currentDataSourceMasterSlaveInfo"
                     shadow="hover">
                <div>
                    <el-descriptions title="‰∏ª‰ªé‰ø°ÊÅØ" direction="vertical" :column="1" border>
                        <el-descriptions-item label="‰∏ªÊú∫IPÔºàMaster_HostÔºâ">
                            {{currentDataSourceMasterSlaveInfo.masterHost}}
                        </el-descriptions-item>
                        <el-descriptions-item label="‰∏ª‰ªéÂ§çÂà∂Áî®Êà∑ÔºàMaster_UserÔºâ">
                            {{currentDataSourceMasterSlaveInfo.masterUser}}
                        </el-descriptions-item>
                        <el-descriptions-item label="‰∏ªÊú∫Á´ØÂè£ÔºàMaster_PortÔºâ">
                            {{currentDataSourceMasterSlaveInfo.masterPort}}
                        </el-descriptions-item>
                        <el-descriptions-item label="‰ªéÂ∫ìÊªûÂêéÊó∂ÈïøÔºàSQL_DelayÔºâÔºåÂçï‰ΩçÔºöÁßí">
                            <div style="color:#8de013;font-weight:bold;font-size: large"
                                 v-if="currentDataSourceMasterSlaveInfo.sqlDelay==0">
                                {{currentDataSourceMasterSlaveInfo.sqlDelay}}
                            </div>
                            <div style="color:red;font-weight:bold;font-size: large"
                                 v-if="currentDataSourceMasterSlaveInfo.sqlDelay!=0">
                                {{currentDataSourceMasterSlaveInfo.sqlDelay}}
                            </div>
                        </el-descriptions-item>
                        <el-descriptions-item label="ËøûÊé•‰∏ªÂ∫ìÂ§±Ë¥•ÊúÄÂ§öÁöÑÈáçËØïÊ¨°Êï∞ÔºàMaster_Retry_CountÔºâ">
                            {{currentDataSourceMasterSlaveInfo.masterRetryCount}}
                        </el-descriptions-item>
                        <el-descriptions-item label="slave I/OÁ∫øÁ®ãÁä∂ÊÄÅÔºàSlave_IO_StateÔºâ">
                            <div style="color:black;font-weight:bold;font-size: large">
                                {{currentDataSourceMasterSlaveInfo.slaveIOState}}
                            </div>
                        </el-descriptions-item>
                        <el-descriptions-item label="Slave_IO_Running">
                            <div style="color:#8de013;font-weight:bold;font-size: large"
                                 v-if="currentDataSourceMasterSlaveInfo.slaveIORunning=='Yes'">
                                {{currentDataSourceMasterSlaveInfo.slaveIORunning}}
                            </div>
                            <div style="color:red;font-weight:bold;font-size: large"
                                 v-if="currentDataSourceMasterSlaveInfo.slaveIORunning!='Yes'">
                                {{currentDataSourceMasterSlaveInfo.slaveIORunning}}
                            </div>
                        </el-descriptions-item>
                        <el-descriptions-item label="Slave_SQL_Running">
                            <div style="color:#8de013;font-weight:bold;font-size: large"
                                 v-if="currentDataSourceMasterSlaveInfo.slaveSQLRunning=='Yes'">
                                {{currentDataSourceMasterSlaveInfo.slaveSQLRunning}}
                            </div>
                            <div style="color:red;font-weight:bold;font-size: large"
                                 v-if="currentDataSourceMasterSlaveInfo.slaveSQLRunning!='Yes'">
                                {{currentDataSourceMasterSlaveInfo.slaveSQLRunning}}
                            </div>
                        </el-descriptions-item>
                        <el-descriptions-item label="Relay_Log_File">{{currentDataSourceMasterSlaveInfo.relayLogFile}}
                        </el-descriptions-item>
                        <el-descriptions-item label="Master_Log_File">
                            {{currentDataSourceMasterSlaveInfo.masterLogFile}}
                        </el-descriptions-item>
                    </el-descriptions>
                </div>
            </el-card>
        </el-aside>
    </el-container>


    <!--Ë°®ÂàõÂª∫ËØ≠Âè•ÂºπÊ°Ü-->
    <el-dialog
            :title="createStatementTableName"
            :visible.sync="createStatementDialog"
            width="38%">
        <el-input
                type="textarea"
                :autosize="{ minRows: 2, maxRows: 20}"
                v-model="createStatementContent">
        </el-input>
        <span slot="footer" class="dialog-footer">
    <el-button type="primary" @click="createStatementDialog = false">Á°Æ ÂÆö</el-button>
  </span>
    </el-dialog>

    <!--JavaÂÆû‰ΩìÁ±ª‰ª£Á†Å-->
    <el-dialog
            :title="createJavaCodeTableName"
            :visible.sync="createJavaCodeDialog"
            width="38%">
        <el-input
                type="textarea"
                :autosize="{ minRows: 2, maxRows: 20}"
                v-model="createJavaCodeContent">
        </el-input>
        <span slot="footer" class="dialog-footer">
    <el-button type="primary" @click="createJavaCodeDialog = false">Á°Æ ÂÆö</el-button>
  </span>
    </el-dialog>

    <!--Ë°® ËØ¶ÁªÜ‰ø°ÊÅØ-->
    <el-dialog :title="tableDetailTableName" :visible.sync="tableDetailDialog" width="38%">
        <el-descriptions v-if="tableDetailInformation!=null">ÁâàÊú¨Âè∑
            <el-descriptions-item label="Ë°®ÊèèËø∞">{{tableDetailInformation.tableInfo.tableComment}}
            </el-descriptions-item>
            <el-descriptions-item label="Ë°åÊï∞">{{tableDetailInformation.tableInfo.rows}}</el-descriptions-item>
            <el-descriptions-item label="Êï∞ÊçÆÂ§ßÂ∞è">{{(tableDetailInformation.tableInfo.dataSize / 1024 /
                1024).toFixed(2)}}MB
                /
                {{tableDetailInformation.tableInfo.dataSize}}B
            </el-descriptions-item>
            <el-descriptions-item label="Á¥¢ÂºïÂ§ßÂ∞è">{{(tableDetailInformation.tableInfo.indexSie / 1024 /
                1024).toFixed(2)}}MB
                /
                {{tableDetailInformation.tableInfo.indexSie}}B
            </el-descriptions-item>
            <el-descriptions-item label="Âπ≥ÂùáÊØèË°åÂ≠óËäÇÊï∞">{{tableDetailInformation.tableInfo.avgRowLength}}B
            </el-descriptions-item>
            <el-descriptions-item v-if="tableDetailInformation.tableInfo.maxDataLenth===0" label="ÊúÄÂ§ßÂÆπÈáè">
                {{(tableDetailInformation.tableInfo.maxDataLenth / 1024 / 1024).toFixed(2)}}MB /
                {{tableDetailInformation.tableInfo.maxDataLenth}}B
            </el-descriptions-item>
            <el-descriptions-item v-else label="ÊúÄÂ§ßÂÆπÈáè">Êó†‰∏äÈôê</el-descriptions-item>

            <el-descriptions-item label="Â≠òÂÇ®ÂºïÊìé">{{tableDetailInformation.tableInfo.engine}}</el-descriptions-item>
            <el-descriptions-item label="Â≠óÁ¨¶ÈõÜ">{{tableDetailInformation.tableInfo.collation}}</el-descriptions-item>
            <el-descriptions-item label="ÂàõÂª∫Êó∂Èó¥">{{tableDetailInformation.tableInfo.createTime}}
            </el-descriptions-item>
            <el-descriptions-item label="Êõ¥Êñ∞Êó∂Èó¥">{{tableDetailInformation.tableInfo.updateTime}}
            </el-descriptions-item>
        </el-descriptions>
        <span slot="footer" style="text" class="dialog-footer">
    <el-button type="primary" @click="tableDetailDialog = false">Á°Æ ÂÆö</el-button>
  </span>
    </el-dialog>

    <!--Êï∞ÊçÆÊ∫ê‰∫ãÂä°-->
    <el-dialog title="‰∫ãÂä°ËØ¶ÊÉÖ" :visible.sync="transDialogTableVisible">
        <el-table :data="trxInfos">
            <el-table-column label="trxId" property="trxId" width="150"></el-table-column>
            <el-table-column label="trx_state" property="trxState" width="150"></el-table-column>
            <el-table-column label="trx_started" property="trxStarted" width="150"></el-table-column>
            <el-table-column label="trx_requested_lock_id" property="trxRequestedLockId" width="150"></el-table-column>
            <el-table-column label="trx_wait_started" property="trxWaitStarted" width="150"></el-table-column>
            <el-table-column label="trx_weight" property="trxWeight" width="150"></el-table-column>
            <el-table-column label="trx_mysql_thread_id" property="trxMysqlThreadId" width="150"></el-table-column>
            <el-table-column label="trx_query" property="trxQuery" width="150"></el-table-column>
            <el-table-column label="trx_operation_state" property="trxOperationState" width="150"></el-table-column>
            <el-table-column label="trx_tables_in_use" property="trxTablesInUse" width="150"></el-table-column>
            <el-table-column label="trx_tables_locked" property="trxTablesLocked" width="150"></el-table-column>
            <el-table-column label="trx_lock_structs" property="trxLockStructs" width="150"></el-table-column>
            <el-table-column label="trx_lock_memory_bytes" property="trxLockMemoryBytes" width="150"></el-table-column>
            <el-table-column label="trx_rows_locked" property="trxRowsLocked" width="150"></el-table-column>
            <el-table-column label="trx_rows_modified" property="trxRowsModified" width="150"></el-table-column>
            <el-table-column label="trx_concurrency_tickets" property="trxConcurrencyTickets"
                             width="150"></el-table-column>
            <el-table-column label="trx_isolation_level" property="trxIsolationLevel" width="150"></el-table-column>
            <el-table-column label="trx_unique_checks" property="trxUniqueChecks" width="150"></el-table-column>
            <el-table-column label="trx_foreign_key_checks" property="trxForeignKeyChecks"
                             width="150"></el-table-column>
            <el-table-column label="trx_last_foreign_key_error" property="trxLastForeignKeyError"
                             width="150"></el-table-column>
            <el-table-column label="trx_adaptive_hash_latched" property="trxAdaptiveHashLatched"
                             width="150"></el-table-column>
            <el-table-column label="trx_adaptive_hash_timeout" property="trxAdaptiveHashTimeout"
                             width="150"></el-table-column>
            <el-table-column label="trx_is_read_only" property="trxIsReadOnly" width="150"></el-table-column>
            <el-table-column label="trx_autocommit_non_locking" property="trxAutocommitNonLocking"
                             width="150"></el-table-column>
        </el-table>
    </el-dialog>

    <!--MyBatisÊñá‰ª∂ÁîüÊàê-->
    <el-dialog v-if="mybatisGenerateDefind" :visible.sync="mybatisGenerateDialogVisible"
               :title="'MyBatisÊñá‰ª∂ÁîüÊàêüçì'+mybatisGenerateDefind.tableName">
        <el-form label-width="120px">
            <el-form-item label="Á±ªÂêç" style="width: 40%">
                <el-input v-model="mybatisGenerateDefind.domainObjName"></el-input>
            </el-form-item>
            <el-form-item label="DaoÈ°πÁõÆË∑ØÂæÑ">
                <el-input v-model="mybatisGenerateDefind.mapperJavaProjectPath"></el-input>
            </el-form-item>
            <el-form-item label="DaoÂåÖË∑ØÂæÑ">
                <el-input v-model="mybatisGenerateDefind.mapperJavaPackagePath"></el-input>
            </el-form-item>
            <el-form-item label="XMLÈ°πÁõÆË∑ØÂæÑ">
                <el-input v-model="mybatisGenerateDefind.mapperXmlProjectPath"></el-input>
            </el-form-item>
            <el-form-item label="XMLÂåÖË∑ØÂæÑ">
                <el-input v-model="mybatisGenerateDefind.mapperXmlPackagePath"></el-input>
            </el-form-item>
            <el-form-item label="XMLÊñá‰ª∂Âêç">
                <el-input v-model="mybatisGenerateDefind.mapperName"></el-input>
            </el-form-item>
            <el-form-item label="ÂÆû‰ΩìÁ±ªÈ°πÁõÆË∑ØÂæÑ">
                <el-input v-model="mybatisGenerateDefind.modelProjectPath"></el-input>
            </el-form-item>
            <el-form-item label="ÂÆû‰ΩìÁ±ªÂåÖË∑ØÂæÑ">
                <el-input v-model="mybatisGenerateDefind.modelPackagePath"></el-input>
            </el-form-item>
            <el-form-item label="ÂäüËÉΩÂºÄÂÖ≥">
                <el-switch width="50" active-text="Ë¶ÜÁõñXML" v-model="mybatisGenerateDefind.overrideXML"></el-switch>
                &nbsp;&nbsp;&nbsp;
                <el-switch active-text="toString" v-model="mybatisGenerateDefind.useToString"></el-switch>
                &nbsp;&nbsp;&nbsp;
                <el-switch active-text="equalsÂíåhashCode" v-model="mybatisGenerateDefind.useEqAndHx"></el-switch>
                &nbsp;&nbsp;&nbsp;
                <el-switch active-text="ÊâπÈáèÊèíÂÖ•Êõ¥Êñ∞ËØ≠Âè•" v-model="mybatisGenerateDefind.useBatch"></el-switch>
                &nbsp;&nbsp;&nbsp;
                <br>
                <el-switch active-text="JSR310" v-model="mybatisGenerateDefind.useJSR310"></el-switch>
                &nbsp;&nbsp;&nbsp;
                <el-switch active-text="Lombok" v-model="mybatisGenerateDefind.useLombok"></el-switch>
                &nbsp;&nbsp;&nbsp;
                <el-switch active-text="‰ΩøÁî®Example" v-model="mybatisGenerateDefind.useExample"></el-switch>
                &nbsp;&nbsp;&nbsp;
            </el-form-item>
            <el-form-item label="‰ΩúËÄÖÂêç" style="width: 40%">
                <el-input v-model="mybatisGenerateDefind.author"></el-input>
            </el-form-item>
            <el-form-item>
                <el-button type="primary" @click="doGenerateMyBatis">Á´ãÂç≥ÂàõÂª∫</el-button>
                <el-button @click="mybatisGenerateDialogVisible = false">ÂèñÊ∂à</el-button>
            </el-form-item>
        </el-form>
    </el-dialog>
</dev>

</body>
<!--Ëé∑ÂèñSpringÁöÑÈÖçÁΩÆÊñá‰ª∂‰ø°ÊÅØ-->
<script th:inline="javascript" type="text/javascript">
    // Ëé∑ÂèñSpringÁöÑcontextPathÁöÑÂÄºÔºåÊãºÊé•Âú®ÂÆûÈôÖËØ∑Ê±ÇË∑ØÂæÑÁöÑÂâçÈù¢
    var context = [[${@Defind.contextPath}]];
</script>
<script th:src="@{js/common.js}"></script>
<script th:src="@{js/sql-formatter.min.js}"></script>
<script th:src="@{js/db.js}"></script>
</html>
