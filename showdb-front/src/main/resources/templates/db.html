<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:v-if="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8">
    <title>ShowDB</title>
    <!--ç›¸å…³å¼•å…¥-->
    <link rel="shortcut icon" th:href="@{img/database.png}">
    <script th:src="@{js/vue.min.js}"></script>
    <script th:src="@{js/axios.min.js}"></script>
    <script src="https://unpkg.com/element-ui/lib/index.js"></script>
    <link rel="stylesheet" th:href="@{css/db.css}">
    <link rel="stylesheet" href="https://unpkg.com/element-ui/lib/theme-chalk/index.css">
</head>
<body>
<dev id="ShowDB">
    <!--é¡¶éƒ¨-->
    <el-alert style="font-weight: bold" v-if="customize!=null"
              :title="customize.topAlert"
              type="success"
              @close="starIt" center>
    </el-alert>

    <el-container>

        <el-aside width="8%" v-if="plugin">
            <!--ä¾§è¾¹ç›®å½•æ -->
            <el-menu :default-active="sidebarDirectory" class="el-menu-demo" @select="handleSidebarDirectory">
                <el-menu-item index="1">æ•°æ®æ–‡æ¡£</el-menu-item>
                <el-menu-item index="2" :disabled="!plugin.execute">æ•°æ®æ‰§è¡Œ</el-menu-item>
                <el-menu-item index="3" :disabled="!plugin.monitor">æ•°æ®ç›‘æ§</el-menu-item>
            </el-menu>
        </el-aside>

        <!--ä¸­é—´åŒºåŸŸæŠ½å–æˆå¯å˜çš„åŒºåŸŸ-->
        <el-main width="48%" style="margin: 10px">

            <!--æ•°æ®æºé€‰å–-->
            <div v-loading="loadingDataSource">
                <el-radio v-model="currentDataSource" @change="dsChange" v-for="(item,index) in dataSorucesInfo"
                          :label="item.beanName" border>{{item.beanName}}
                </el-radio>
            </div>
            <!-- æ–‡æ¡£-->
            <div v-if="sidebarDirectory == '1'" th:include="component/doc :: doc"></div>
            <!--SQLæ‰§è¡Œ-->
            <div v-if="sidebarDirectory == '2'" th:include="component/execute :: execute"></div>
            <!--ç›‘æ§-->
            <div v-if="sidebarDirectory == '3'" th:include="component/monitor :: monitor"></div>
        </el-main>

        <!--å³ä¾§æ•°æ®æº-->
        <el-aside width="20%" style="margin-top: 10px;margin-left: 10px">
            <!--customize-->
            <el-card v-if="customize" :body-style="{ padding: '0px' }"
                     style="width:80%;overflow-x: auto" shadow="hover">
                <img :src="customize.img" class="image" style="width: 100%;display: block;">
                <div style="padding: 14px;">
                    <span style="font-size: large">ğŸ‘¤  {{customize.creator}}</span><br>
                    <span style="font-size: large">ğŸ“®  {{customize.email}}</span><br>
                    <span style="font-size: large">ğŸ—’  {{customize.desc}}</span><br>
                </div>
            </el-card>
            <el-empty v-if="customize==null" description="æš‚æ— è‡ªå®šä¹‰æè¿°ä¿¡æ¯"></el-empty>
        </el-aside>
    </el-container>


    <!--è¡¨åˆ›å»ºè¯­å¥å¼¹æ¡†-->
    <el-dialog
            :title="createStatementTableName"
            :visible.sync="createStatementDialog"
            width="38%">
        <el-input
                type="textarea"
                :autosize="{ minRows: 2, maxRows: 20}"
                v-model="createStatementContent">
        </el-input>
        <span slot="footer" class="dialog-footer">
    <el-button type="primary" @click="createStatementDialog = false">ç¡® å®š</el-button>
  </span>
    </el-dialog>

    <!--Javaå®ä½“ç±»ä»£ç -->
    <el-dialog
            :title="createJavaCodeTableName"
            :visible.sync="createJavaCodeDialog"
            width="38%">
        <el-input
                type="textarea"
                :autosize="{ minRows: 2, maxRows: 20}"
                v-model="createJavaCodeContent">
        </el-input>
        <span slot="footer" class="dialog-footer">
    <el-button type="primary" @click="createJavaCodeDialog = false">ç¡® å®š</el-button>
  </span>
    </el-dialog>

    <!--è¡¨ è¯¦ç»†ä¿¡æ¯-->
    <el-dialog :title="tableDetailTableName" :visible.sync="tableDetailDialog" width="38%">
        <el-descriptions v-if="tableDetailInformation!=null">ç‰ˆæœ¬å·
            <el-descriptions-item label="è¡¨æè¿°">{{tableDetailInformation.tableInfo.tableComment}}
            </el-descriptions-item>
            <el-descriptions-item label="è¡Œæ•°">{{tableDetailInformation.tableInfo.rows}}</el-descriptions-item>
            <el-descriptions-item label="æ•°æ®å¤§å°">{{(tableDetailInformation.tableInfo.dataSize / 1024 /
                1024).toFixed(2)}}MB
                /
                {{tableDetailInformation.tableInfo.dataSize}}B
            </el-descriptions-item>
            <el-descriptions-item label="ç´¢å¼•å¤§å°">{{(tableDetailInformation.tableInfo.indexSie / 1024 /
                1024).toFixed(2)}}MB
                /
                {{tableDetailInformation.tableInfo.indexSie}}B
            </el-descriptions-item>
            <el-descriptions-item label="å¹³å‡æ¯è¡Œå­—èŠ‚æ•°">{{tableDetailInformation.tableInfo.avgRowLength}}B
            </el-descriptions-item>
            <el-descriptions-item v-if="tableDetailInformation.tableInfo.maxDataLenth===0" label="æœ€å¤§å®¹é‡">
                {{(tableDetailInformation.tableInfo.maxDataLenth / 1024 / 1024).toFixed(2)}}MB /
                {{tableDetailInformation.tableInfo.maxDataLenth}}B
            </el-descriptions-item>
            <el-descriptions-item v-else label="æœ€å¤§å®¹é‡">æ— ä¸Šé™</el-descriptions-item>

            <el-descriptions-item label="å­˜å‚¨å¼•æ“">{{tableDetailInformation.tableInfo.engine}}</el-descriptions-item>
            <el-descriptions-item label="å­—ç¬¦é›†">{{tableDetailInformation.tableInfo.collation}}</el-descriptions-item>
            <el-descriptions-item label="åˆ›å»ºæ—¶é—´">{{tableDetailInformation.tableInfo.createTime}}
            </el-descriptions-item>
            <el-descriptions-item label="æ›´æ–°æ—¶é—´">{{tableDetailInformation.tableInfo.updateTime}}
            </el-descriptions-item>
        </el-descriptions>
        <span slot="footer" style="text" class="dialog-footer">
    <el-button type="primary" @click="tableDetailDialog = false">ç¡® å®š</el-button>
  </span>
    </el-dialog>

    <!--æ•°æ®æºäº‹åŠ¡-->
    <el-dialog title="äº‹åŠ¡è¯¦æƒ…" :visible.sync="transDialogTableVisible">
        <el-table :data="trxInfos">
            <el-table-column label="trxId" property="trxId" width="150"></el-table-column>
            <el-table-column label="trx_state" property="trxState" width="150"></el-table-column>
            <el-table-column label="trx_started" property="trxStarted" width="150"></el-table-column>
            <el-table-column label="trx_requested_lock_id" property="trxRequestedLockId" width="150"></el-table-column>
            <el-table-column label="trx_wait_started" property="trxWaitStarted" width="150"></el-table-column>
            <el-table-column label="trx_weight" property="trxWeight" width="150"></el-table-column>
            <el-table-column label="trx_mysql_thread_id" property="trxMysqlThreadId" width="150"></el-table-column>
            <el-table-column label="trx_query" property="trxQuery" width="150"></el-table-column>
            <el-table-column label="trx_operation_state" property="trxOperationState" width="150"></el-table-column>
            <el-table-column label="trx_tables_in_use" property="trxTablesInUse" width="150"></el-table-column>
            <el-table-column label="trx_tables_locked" property="trxTablesLocked" width="150"></el-table-column>
            <el-table-column label="trx_lock_structs" property="trxLockStructs" width="150"></el-table-column>
            <el-table-column label="trx_lock_memory_bytes" property="trxLockMemoryBytes" width="150"></el-table-column>
            <el-table-column label="trx_rows_locked" property="trxRowsLocked" width="150"></el-table-column>
            <el-table-column label="trx_rows_modified" property="trxRowsModified" width="150"></el-table-column>
            <el-table-column label="trx_concurrency_tickets" property="trxConcurrencyTickets"
                             width="150"></el-table-column>
            <el-table-column label="trx_isolation_level" property="trxIsolationLevel" width="150"></el-table-column>
            <el-table-column label="trx_unique_checks" property="trxUniqueChecks" width="150"></el-table-column>
            <el-table-column label="trx_foreign_key_checks" property="trxForeignKeyChecks"
                             width="150"></el-table-column>
            <el-table-column label="trx_last_foreign_key_error" property="trxLastForeignKeyError"
                             width="150"></el-table-column>
            <el-table-column label="trx_adaptive_hash_latched" property="trxAdaptiveHashLatched"
                             width="150"></el-table-column>
            <el-table-column label="trx_adaptive_hash_timeout" property="trxAdaptiveHashTimeout"
                             width="150"></el-table-column>
            <el-table-column label="trx_is_read_only" property="trxIsReadOnly" width="150"></el-table-column>
            <el-table-column label="trx_autocommit_non_locking" property="trxAutocommitNonLocking"
                             width="150"></el-table-column>
        </el-table>
    </el-dialog>

    <!--MyBatisæ–‡ä»¶ç”Ÿæˆ-->
    <el-dialog v-if="mybatisGenerateDefind" :visible.sync="mybatisGenerateDialogVisible"
               :title="'MyBatisæ–‡ä»¶ç”ŸæˆğŸ“'+mybatisGenerateDefind.tableName">
        <el-form label-width="120px">
            <el-form-item label="ç±»å" style="width: 40%">
                <el-input v-model="mybatisGenerateDefind.domainObjName"></el-input>
            </el-form-item>
            <el-form-item label="Daoé¡¹ç›®è·¯å¾„">
                <el-input v-model="mybatisGenerateDefind.mapperJavaProjectPath"></el-input>
            </el-form-item>
            <el-form-item label="DaoåŒ…è·¯å¾„">
                <el-input v-model="mybatisGenerateDefind.mapperJavaPackagePath"></el-input>
            </el-form-item>
            <el-form-item label="XMLé¡¹ç›®è·¯å¾„">
                <el-input v-model="mybatisGenerateDefind.mapperXmlProjectPath"></el-input>
            </el-form-item>
            <el-form-item label="XMLåŒ…è·¯å¾„">
                <el-input v-model="mybatisGenerateDefind.mapperXmlPackagePath"></el-input>
            </el-form-item>
            <el-form-item label="XMLæ–‡ä»¶å">
                <el-input v-model="mybatisGenerateDefind.mapperName"></el-input>
            </el-form-item>
            <el-form-item label="å®ä½“ç±»é¡¹ç›®è·¯å¾„">
                <el-input v-model="mybatisGenerateDefind.modelProjectPath"></el-input>
            </el-form-item>
            <el-form-item label="å®ä½“ç±»åŒ…è·¯å¾„">
                <el-input v-model="mybatisGenerateDefind.modelPackagePath"></el-input>
            </el-form-item>
            <el-form-item label="åŠŸèƒ½å¼€å…³">
                <el-switch width="50" active-text="è¦†ç›–XML" v-model="mybatisGenerateDefind.overrideXML"></el-switch>
                &nbsp;&nbsp;&nbsp;
                <el-switch active-text="toString" v-model="mybatisGenerateDefind.useToString"></el-switch>
                &nbsp;&nbsp;&nbsp;
                <el-switch active-text="equalså’ŒhashCode" v-model="mybatisGenerateDefind.useEqAndHx"></el-switch>
                &nbsp;&nbsp;&nbsp;
                <el-switch active-text="æ‰¹é‡æ’å…¥æ›´æ–°è¯­å¥" v-model="mybatisGenerateDefind.useBatch"></el-switch>
                &nbsp;&nbsp;&nbsp;
                <br>
                <el-switch active-text="JSR310" v-model="mybatisGenerateDefind.useJSR310"></el-switch>
                &nbsp;&nbsp;&nbsp;
                <el-switch active-text="Lombok" v-model="mybatisGenerateDefind.useLombok"></el-switch>
                &nbsp;&nbsp;&nbsp;
                <el-switch active-text="ä½¿ç”¨Example" v-model="mybatisGenerateDefind.useExample"></el-switch>
                &nbsp;&nbsp;&nbsp;
            </el-form-item>
            <el-form-item label="ä½œè€…å" style="width: 40%">
                <el-input v-model="mybatisGenerateDefind.author"></el-input>
            </el-form-item>
            <el-form-item>
                <el-button type="primary" @click="doGenerateMyBatis">ç«‹å³åˆ›å»º</el-button>
                <el-button @click="mybatisGenerateDialogVisible = false">å–æ¶ˆ</el-button>
            </el-form-item>
        </el-form>
    </el-dialog>
</dev>

</body>
<!--è·å–Springçš„é…ç½®æ–‡ä»¶ä¿¡æ¯-->
<script th:inline="javascript" type="text/javascript">
    // è·å–Springçš„contextPathçš„å€¼ï¼Œæ‹¼æ¥åœ¨å®é™…è¯·æ±‚è·¯å¾„çš„å‰é¢
    var context = [[${@Defind.contextPath}]];
</script>
<script th:src="@{js/common.js}"></script>
<script th:src="@{js/sql-formatter.min.js}"></script>
<script th:src="@{js/db.js}"></script>
</html>
